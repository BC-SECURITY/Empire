name: Invoke-SpoolSample
authors:
  - name: Lee Christensen
    handle: '@tifkin_'
    link: https://twitter.com/tifkin_
  - name: ''
    handle: '@kevin'
    link: ''
description: |
  Runs SpoolSample C# binary through reflection
software:
tactics: [TA0006. TA0009]
techniques: [T1550.002, T1557.001, T1557.002, T1187]
background: false
output_extension:
needs_admin: false
opsec_safe: true
language: powershell
min_language_version: '2'
comments:
  - https://github.com/leechristensen/SpoolSample
  - https://www.ired.team/offensive-security-experiments/active-directory-kerberos-abuse/domain-compromise-via-dc-print-server-and-kerberos-delegation
options:
  - name: Agent
    description: Agent to run module on.
    required: true
    value: ''
  - name: Target
    description: Target to send MS-RPRN request.
    required: true
    value: ''
  - name: CaptureServer
    description: Host that receives SMB auth from the target.
    required: true
    value: ''
script_path: exploitation/Invoke-SpoolSample.ps1
script_end: Invoke-SpoolSample {{ PARAMS }}
